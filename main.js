(()=>{"use strict";function t(t){const e=t;let o=0;return{getLength:()=>e,isSunk:()=>o>=e,getHit:()=>{o++}}}function e(t=5){const e=t,o=new Map,r=new Map;let a=0;const n=(t,e)=>r.has(`${t} ${e}`);return{recieveAttack:(t,e)=>{if(n(t,e))return"You've already attacked this place!";const c=o.get(`${t} ${e}`);return c?(r.set(`${t} ${e}`,!0),c.getHit(),c.isSunk()&&(a+=1),"Attack Hit!"):(r.set(`${t} ${e}`,!1),"Attack Missed!")},getBoard:()=>o,allShipsSunk:()=>a>=e,getSeenAttacks:()=>r,hasSeenAttack:n}}function o(t=!1){const e=t;return{playMove:(t,...o)=>{if(e)return void(t=>{let e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());for(;t.hasSeenAttack(e,o);)e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random());t.recieveAttack(e,o)})(t);const r=o[0],a=o[1];t.recieveAttack(r,a)}}}!function(){const r=function(){const r=[o(),o(!0)],a=[e(),e()],n=[t(2),t(3),t(3),t(4),t(5)],c=[t(2),t(3),t(3),t(4),t(5)],s=(t,e,o,r=!0,a)=>{r?l(t,e,o,a):d(t,e,o,a)},d=(t,e,o,r)=>{for(let a=o;a<o+t.getLength();a++)r.getBoard().set(`${e} ${a}`,t)},l=(t,e,o,r)=>{for(let a=e;a<e+t.getLength();a++)r.getBoard().set(`${a} ${o}`,t)};return s(n[0],0,0,!0,a[0]),s(n[1],2,3,!1,a[0]),s(n[2],5,3,!1,a[0]),s(n[3],6,0,!0,a[0]),s(n[4],5,9,!0,a[0]),s(c[0],0,0,!0,a[1]),s(c[1],2,3,!1,a[1]),s(c[2],5,3,!1,a[1]),s(c[3],6,0,!0,a[1]),s(c[4],5,9,!0,a[1]),{players:r,boards:a}}(),a=document.querySelector("#player"),n=document.querySelector("#enemy"),c=t=>{t.replaceChildren();for(let e=0;e<10;e++)for(let o=0;o<10;o++){const r=document.createElement("button");r.dataset.coord=`${e} ${o}`,t.appendChild(r)}},s=(t,e)=>{const o=e.getSeenAttacks().entries();console.log(o);for(const e of o)e[1]?document.querySelector(`${t} [data-coord='${e[0]}']`).innerHTML="X":document.querySelector(`${t} [data-coord='${e[0]}']`).classList.add("miss")},d=()=>{c(a),c(n),((t,e)=>{const o=e.getBoard().keys();for(const t of o)document.querySelector(`#player [data-coord='${t}']`).classList.add("ship")})(0,r.boards[0]),s("#player",r.boards[0]),s("#enemy",r.boards[1]),l()},l=()=>{document.querySelectorAll("#enemy > button").forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.dataset.coord.split(" ");console.log(e);const o=parseInt(e[0]),a=parseInt(e[1]);r.boards[1].recieveAttack(o,a),r.players[1].playMove(r.boards[0]),d()}))}))};d()}()})();